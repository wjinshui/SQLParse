SELECT id FROM PERSON
WHERE [year_born] = 1935;

 ******************************

SELECT count(*)
FROM movie m 
WHERE EXISTS (SELECT production_year FROM movie WHERE 1991 <production_year<1993 );
 ******************************

select count(*)
from movie
where production_year>1990 & production_year<1994;
 ******************************

SELECT count(*),production_year
FROM movie
GROUP BY production_year
HAVING 1990<movie.production_year<1994;
 ******************************

 select production_year
 from movie m
 where 1990<m.production_year<1994;
 ******************************

SELECT id FROM PERSON WHERE year_born=
(SELECT MAX(year_born) FROM PERSON)>
(SELECT MAX(year_born) FROM PERSON);
 ******************************

select id, year_born desc from person
order by year_born desc
limit 1,1;
 ******************************

DELETE FROM person p1
WHERE year_born=(SELECT MAX(year_born) FROM person p1）
SELECT id 
FROM person p2
WHERE year_born=(SELECT MAX(year_of_born)FROM person p2);
 ******************************

DELETE FROM person 
WHERE year_born=(SELECT MAX(year_born) FROM person）
SELECT id 
FROM person 
WHERE year_born=(SELECT MAX(year_of_born)FROM person);
 ******************************

DELETE FROM person p 
WHERE p.year_born=(SELECT MAX(p.year_born) FROM p）
SELECT id.p
FROM person p 
WHERE p.year_born=(SELECT MAX(p.year_of_born)FROM p);
 ******************************

SELECT person.id, person.first_name, person.last_name
FROM person INNER JOIN writer INNER JOIN director
ON person.id = writer.id = director.id
GROUP BY person.id
HAVING COUNT(*) >= 2;

 ******************************

SELECT p.id, last_name, first_name FROM person p 
WHERE EXISTS (SELECT COUNT(*) FROM writer w, movie m WHERE w.title = m.title >1);
 ******************************

SELECT p.id,p.first_name,p.last_name
FROM person p,director d,writer w
WHERE p.id=d.id=w.id
GROUP BY w.id, w.title, w.production_year
HAVING COUNT(d.id)>2;
 ******************************

select p.id, p.first_name, p.last_name, count(*)
from person p, director d, writer w
where p.id=d.id=w.id
group by p.id, p.first_name, p.last_name
having count(*)>1;
 ******************************

SELECT p.id,p.first_name,p.last_name
from person p
where exists (select *
from director e, writer w
where e.id=p.id=w.id
group by e.id and w.id
having count(*)>=2);
 ******************************

select p.id, p.first_name, p.last_name from person p, writer w, director d where p.id=w.id=d.id and w.title=d.title group by p.id having count(*)>=2;
 ******************************

SELECT country
FROM RESTRICTION r
WHERE EXISTS (SELECT * FROM RESTRICTION_CATEGORY rc WHERE r.description=rc.description='M');
 ******************************

select restriction.country from restriction,restriction_category,movie where 
restriction.country = restriction_category.country and movie.country=restriction.country 
and movie.title="Shakespeare in love as 'M'";
 ******************************

select count(*)
from (writer_award natural join person) as wp
where lower(wp.first_name) ='woody' and lower(last_name)='allen' and 1991<year_of_award<=1995;
 ******************************

SELECT count(*) from 
	(SELECT award_name from writer_award wa, writer w, person p
	WHERE wa.id=w.id=p.id
	AND wa.production_year in (1991,1992,1993,1994,1995)
	And lower(p.first_name)='woody'
	And lower(p.last_name)='allen') as a;
 ******************************

SELECT wa.award_name,count(*)
FROM (person NATURAL JOIN writer_award ) AS wa
WHERE wa.first_name = 'Woody' AND wa.last_name = 'Allen'
GROUP BY wa.award_name 
HAVING 1991<wa.year_of_award <1995;
 ******************************

SELECT count(*) as TOTAL
FROM writer_award wa, person p, writer w
WHERE wa.title = w.title AND wa.production_year = w.production_year
AND wa.id = w.id = p.id
AND lower(RESULT) = 'won'
AND lower(first_name) = 'woody'
AND lower(last_name) = 'allen'
AND year_of_award>=1991
AND year_of_award<=1995;
 ******************************

select count(*)
from director_award da,  director d, person p
where (1991<da.production_year<=1995 ) and (da.result='won') and (da.title=d.title)
       and (p.id=p.id) and (p.first_name='Woody Allen')
;
 ******************************

SELECT person.id
FROM movie, role, appearance, person
WHERE movie.title = role.title = appearance.title AND movie.production_year = role.production_year = appearance.production_year
	AND role.id = person.id
	AND movie.title = 'Psycho'
	AND movie.production_year = 1960
	AND appearance.scene_no = 1;
 ******************************

SELECT id
FROM;

 ******************************

SELECT pr.id
FROM (SELECT * FROM person,role WHERE person.id=role.id) AS pr, 
(SELECT * FROM movie,scene WHERE movie.title=scene.title AND movie.production_year=scene.production_year) AS ms
WHERE lower(pr.title)=lower(ms.title)="psycho"
AND pr.production_year=ms.production_year=1960
GROUP BY pr.id HAVING COUNT(ms.scene_no)=1;
 ******************************

SELECT p.id
FROM person p, scene s, movie m, role r
WHERE p.id = r.id
AND r.title = m.title
AND m.title = s.title = 'Psycho'
AND m.production_year = s.production_year
AND s.production_year = '1960'
AND (SELECT COUNT(*)
     FROM scene
	 WHERE scene_no = '1');
 ******************************

SELECT  id
FROM (SELECT *
FROM ROLE r ,SCENE n
WHERE lower(r.title) =lower(n.title)='psycho' AND r.production_year AND n.production_year=1960)AS rn
GROUP BY rn.scene_no
HAVING COUNT(id)=1;

 ******************************

SELECT id
FROM ROLE r
WHERE EXISTS (SELECT * FROM APPEARANCE ap, SCENE s
WHERE r.title=ap.title=s.title AND r.production_year=ap.production_year=s.production_year
AND r.description=ap.description=s.description AND ap.scene_no=s.scene_no AND ap.production_year=1960 AND ap.title='psycho')
GROUP BY id
HAVING COUNT(*)=1;
 ******************************

SELECT id 
FROM scene s,
     role r,
     appearance ap
WHERE lower(s.title=r.title=ap.title)='psycho' AND s.production_year=r.production_year=ap.production_year=1960 AND lower(s.scene_no=ap.scene_no)='one' AND 
lower(ap.description)='exactly';
     
 ******************************

SELECT COUNT(*) AS number_of_non_awarded_movies
FROM movie a, movie_award b, crew_award c, director_award d, writer_award e, actor_award f
WHERE a.title=b.title=c.title=d.title=e.title=f.title 
AND b.result!='yes'
AND c.result!='yes'
AND d.result!='yes'
AND e.result!='yes'
AND f.result!='yes';
 ******************************

SELECT count(*)
FROM movie m
WHERE NOT EXISTS (SELECT * 
FROM movie_award ma,crew_award ca,director_award da,writer_award wa,actor_award aa
WHERE m.title=ma.title=ca.title=da.title=wa.title=aa.title
AND m.production_year=ma.production_year=ca.production_year=da.production_year=wa.production_year=aa.production_year);
 ******************************

WITH notwon AS (
	WITH aout AS(
			SELECT title, production_year, result
			FROM actor_award aw
			UNION
			SELECT title, production_year, result
			FROM movie_award
			UNION
			SELECT title, production_year, result
			FROM director_award
			UNION
			SELECT title, production_year, result
			FROM crew_award
			UNION
			SELECT title, production_year, result
			FROM writer_award
		)
	SELECT DISTINCT m.title, m.production_year
	FROM aout, movie m
	WHERE lower(aout.result) = 'won'
		AND m.title != aout.title
		AND m.production_year != aout.production_year
)
SELECT COUNT(*)
FROM notwon
;

 ******************************

WITH notwon AS (
	WITH aout AS(
			SELECT title, production_year, result
			FROM actor_award aw
			WHERE lower(result) = 'won'
			UNION
			SELECT title, production_year, result
			FROM movie_award
			WHERE lower(result) = 'won'
			UNION
			SELECT title, production_year, result
			FROM director_award
			WHERE lower(result) = 'won'
			UNION
			SELECT title, production_year, result
			FROM crew_award
			WHERE lower(result) = 'won'
			UNION
			SELECT title, production_year, result
			FROM writer_award
			WHERE lower(result) = 'won'
		)
	SELECT DISTINCT m.title, m.production_year
	FROM aout, movie m
	WHERE m.title != aout.title
		AND m.production_year != aout.production_year
)
SELECT COUNT(*)
FROM notwon
;

 ******************************

SELECT DISTINCT p.id 
FROM person AS p, writer AS w, director AS d, 
(SELECT COUNT(m.title) AS noOfmovie
FROM movie AS m, writer AS w, director AS d 
WHERE m.title=w.title=d.title 
AND m.production_year=w.production_year=d.production_year 
GROUP BY m.title 
HAVING noOfmovie=MAX(m.title))
WHERE p.id=d.id
OR p.id=w.id
OR p.id=w.id=d.id;
 ******************************

SELECT 
	p.id,
	count(*)
FROM 
	person p,
	writer w,
	director d
WHERE 
	p.id = w.id
	OR 
	p.id = d.id
	OR
	p.id = d.id = w.id ;
 ******************************

select p.first_name, p.last_name
from person p
where p.id = 

(with y as
(select x1.id, count(*) As MostRoles
	from (select r.id, r.title, r.production_year, r.description
		from role as r)x1
	group by x1.id)
select y.id from y where
y.MostRoles = (select MAX(y.MostRoles)from y));
 ******************************

